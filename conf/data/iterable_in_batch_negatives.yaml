max_contexts_per_batch: 400
max_questions_per_batch: 64

datamodule:
  _target_: golden_retriever.lightning_modules.pl_data_modules.PLDataModule
  tokenizer: ${model.language_model}
  datasets:
    train:
      _target_: golden_retriever.data.dpr_datasets.InBatchNegativesDPRIterableDataset
      name: 'train'
      contexts_path: ${data_overrides.contexts_path}
      max_context_length: 64
      max_questions_per_batch: ${data.max_questions_per_batch}
      # max_negatives_to_sample: 200
      # max_contexts: 200
      prefetch_batches: True
      max_contexts_per_batch: ${data.max_contexts_per_batch}
      shuffle: True
      path: ${data_overrides.train_path}

    val:
      - _target_: golden_retriever.data.dpr_datasets.InBatchNegativesDPRIterableDataset
        name: 'val'
        contexts_path: ${data_overrides.contexts_path}
        max_context_length: 64
        max_questions_per_batch: ${data.max_questions_per_batch}
        # max_negatives_to_sample: 200
        # max_contexts: 200
        prefetch_batches: True
        max_contexts_per_batch: ${data.max_contexts_per_batch}
        path: ${data_overrides.val_path}

    test:
      - _target_: golden_retriever.data.dpr_datasets.InBatchNegativesDPRIterableDataset
        name: 'test'
        contexts_path: ${data_overrides.contexts_path}
        max_context_length: 64
        max_questions_per_batch: ${data.max_questions_per_batch}
        # max_negatives_to_sample: 200
        # max_contexts: 200
        prefetch_batches: True
        max_contexts_per_batch: ${data.max_contexts_per_batch}
        path: ${data_overrides.test_path}
